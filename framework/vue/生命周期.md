# 生命周期

## 一、什么是生命周期

​        每个vue实例在被创建时都要经过一系列的初始化过程——例如，需要设置数据监听、编译模板、将实例挂载到DOM并在数据变化时更新DOM等，称为Vue实例的生命周期。

## 二、图示

![生命周期](./images/lifecycle.png)

## 三、生命周期钩子

> 生命周期钩子指的是在不同的阶段触发的函数。

### （一）钩子列表

| 事件                            | 说明                                                         |
| ------------------------------- | ------------------------------------------------------------ |
| beforeCreate                    | 在实例初始化之后，数据观测 (data observer) 和 event/watcher 事件配置之前被调用。 |
| created                         | 在实例创建完成后被立即调用。在这一步，实例已完成以下的配置：数据观测 (data observer)，property 和methods的运算，watch/event 事件回调。然而，挂载阶段还没开始，`$el` property 目前尚不可用。 |
| beforeMount                     | 在挂载开始之前被调用：相关的 `render` 函数首次被调用。       |
| mounted                         | 实例被挂载后调用，这时 `el` 被新创建的 `vm.$el` 替换了。如果根实例挂载到了一个文档内的元素上，当 `mounted` 被调用时 `vm.$el` 也在文档内。**该钩子在服务器端渲染期间不被调用。** |
| beforeUpdate                    | 数据更新时调用，发生在虚拟 DOM 打补丁之前。这里适合在更新之前访问现有的 DOM，比如手动移除已添加的事件监听器。 |
| updated                         | 由于数据更改导致的虚拟 DOM 重新渲染和打补丁，在这之后会调用该钩子。当这个钩子被调用时，组件 DOM 已经更新，所以你现在可以执行依赖于 DOM 的操作。然而在大多数情况下，你应该避免在此期间更改状态。如果要相应状态改变，通常最好使用[计算属性](https://cn.vuejs.org/v2/api/#computed)或 [watcher](https://cn.vuejs.org/v2/api/#watch) 取而代之。注意 `updated` **不会**保证所有的子组件也都一起被重绘。如果你希望等到整个视图都重绘完毕，可以在 `updated` 里使用 [vm.$nextTick](https://cn.vuejs.org/v2/api/#vm-nextTick)： |
| actived                         | 被 keep-alive 缓存的组件激活时调用。**该钩子在服务器端渲染期间不被调用。** |
| deactived                       | 被 keep-alive 缓存的组件停用时调用。**该钩子在服务器端渲染期间不被调用。** |
| beforeDestory                   | 实例销毁之前调用。在这一步，实例仍然完全可用。**该钩子在服务器端渲染期间不被调用。** |
| destroyed                       | 实例销毁后调用。该钩子被调用后，对应 Vue 实例的所有指令都被解绑，所有的事件监听器被移除，所有的子实例也都被销毁。**该钩子在服务器端渲染期间不被调用。** |
| errorCaptured（2.5.0+以上版本） | 当捕获一个来自子孙组件的错误时被调用。此钩子会收到三个参数：错误对象、发生错误的组件实例以及一个包含错误来源信息的字符串。此钩子可以返回 `false` 以阻止该错误继续向上传播。你可以在此钩子中修改组件的状态。因此在捕获错误时，在模板或渲染函数中有一个条件判断来绕过其它内容就很重要；不然该组件可能会进入一个无限的渲染循环。 |

### （二）事件简述

- created：调用编译器将`.*vue`文件编译成`*.js`文件。创建`Vue`实例，也就是一个`Vue`对象。对象包括基本属性: data、watch、methods等属性。此处可以对`Vue`对象进行操作，但是对于DOM的操作无法进行。
- `beforeMount`: 调用`render`函数，生成虚拟DOM
- `mounted`：将虚拟DOM挂载到真实DOM上。

## 四、其他

- 注意：不要在生命周期方法和其他组件属性上使用回调函数，这样会造成this无法绑定到实例。原因：箭头函数并没有 `this`，`this` 会作为变量一直向上级词法作用域查找，直至找到为止。